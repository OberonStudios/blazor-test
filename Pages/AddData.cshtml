@page "/adddata"
@inject HttpClient Http
@inject Microsoft.AspNetCore.Blazor.Services.IUriHelper UriHelper

<h1>Add a person</h1>

<form>
  <div class="form-group">
    <label for="name">Name</label>
    <input bind="@current_name" type="text" class="form-control" id="name" />
    <small id="emailHelp" class="form-text text-muted">We'll never share your data with anyone else... I promise</small>
  </div>
  <div class="form-group">
    <label for="nonce">Nonce</label>
    <input bind="@current_id" type="number" class="form-control" id="nonce" />
    <small id="emailHelp" class="form-text text-muted">This is going to be your id</small>
  </div>
</form>
<button class="btn btn-primary" onclick="@addPerson">Click me</button>
<button class="btn btn-danger" onclick="@goHome">Home</button>


@functions {
    string current_name;
    int current_id;

    protected async Task addPerson()
    {
        await Http.SendJsonAsync(
          HttpMethod.Post,
          "https://fxns-at-azure.azurewebsites.net/api/post_data", 
          new Person{id=current_id, name=current_name}
        );

        UriHelper.NavigateTo("/fetchdata");
    }
    void goHome()
    {
      UriHelper.NavigateTo("/");
    }

    class Person
    {
        public int id { get; set; }
        public string name { get; set; }
    }
}

